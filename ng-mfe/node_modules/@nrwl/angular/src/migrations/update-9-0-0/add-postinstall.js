"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const workspace_1 = require("@nrwl/workspace");
const schematics_1 = require("@angular-devkit/schematics");
function default_1() {
    return (0, schematics_1.chain)([
        (0, workspace_1.updateJsonInTree)('package.json', (json, context) => {
            json.scripts = json.scripts || {};
            const command = 'ngcc --properties es2015 browser module main --first-only --create-ivy-entry-points';
            if (!json.scripts.postinstall) {
                json.scripts.postinstall = command;
            }
            else if (!json.scripts.postinstall.includes('ngcc')) {
                json.scripts.postinstall = `${json.scripts.postinstall} && ${command}`;
            }
            return json;
        }),
        (0, workspace_1.formatFiles)(),
    ]);
}
exports.default = default_1;
//# sourceMappingURL=add-postinstall.js.map